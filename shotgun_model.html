



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Shotgun Model &mdash; tk-framework-shotgunutils master documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Shotgun Hierarchy Model" href="shotgun_hierarchy_model.html" />
    <link rel="prev" title="The Shotgun Utilities Framework" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          
    <a href='http://developer.shotgridsoftware.com'>
    
        <img style='width: 191px;
                height: 60px;
                margin: 2px;
                border-radius: 0px;
                padding: 0px;'
            src='_static/logo@2x.png'/>
    
    </a>
    

          
            <a href="index.html" class="icon icon-home"> tk-framework-shotgunutils
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Shotgun Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#why-should-i-use-the-shotgun-model">Why should I use the Shotgun Model?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#shotgun-model-hello-world">Shotgun Model Hello World</a></li>
<li class="toctree-l3"><a class="reference internal" href="#beyond-hello-world">Beyond Hello World</a></li>
<li class="toctree-l3"><a class="reference internal" href="#progress-spinner">Progress Spinner</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-items">Data Items</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#simpleshotgunmodel">SimpleShotgunModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#shotgunentitymodel">ShotgunEntityModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#shotgunmodel">ShotgunModel</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="shotgun_hierarchy_model.html">Shotgun Hierarchy Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="shotgun_data.html">Shotgun Asynchronous Data Retriever</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_manager.html">Background Task Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="settings.html">Shotgun Toolkit Qt Settings Wrapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="shotgun_globals.html">Shotgun Globals Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="external_config.html">External Configuration Management</a></li>
</ul>

            
          

    <a href='genindex.html'>Alphabetic Index</a>

    <div style='margin-top: 50px;
                margin-left: 10px;
                margin-right: 10px;
                padding: 10px;
                color: #b3b3b3;
                font-size: 70%;
                border-radius: 3px;
                background-color: #444;
                line-height: 18px;
                '>
    <style>
        a.custom_post_menu { display: inline;
                             padding: 0px;
                             text-decoration: underline; }
    </style>

    <b>tk-framework-shotgunutils</b> master.<br>
    
        This documentation is part of the Shotgun Pipeline Toolkit.
    
    For more information, please visit
    <a class=custom_post_menu href='https://developer.shotgridsoftware.com'>Shotgun Support</a>.
    The code associated with this documentation can be found
    <a class=custom_post_menu href='https://github.com/shotgunsoftware/tk-framework-shotgunutils'>here</a>.

    </div>



        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">tk-framework-shotgunutils</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Shotgun Model</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="shotgun-model">
<h1>Shotgun Model<a class="headerlink" href="#shotgun-model" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The shotgun data model helps you build responsive, data rich applications quickly and leverage
Qt’s built-in model/view framework</p>
<img alt="_images/model_overview.png" src="_images/model_overview.png" />
<p>The Shotgun Model is a custom Qt Model specialized for Shotgun Queries. It uses a disk based cache
and runs queries asynchronously to Shotgun in the background for performance. In a nut shell, you
derive your own model class from it, set up a query, and then hook up your model to a Qt View which
will draw the data. The class contains several callbacks and allows for extensive customization, yet
tries to shadow and encapsulate a lot of the details.</p>
<img alt="_images/model_inheritance.png" src="_images/model_inheritance.png" />
<div class="section" id="why-should-i-use-the-shotgun-model">
<h3>Why should I use the Shotgun Model?<a class="headerlink" href="#why-should-i-use-the-shotgun-model" title="Permalink to this headline">¶</a></h3>
<p>Using the Shotgun Model means switching to Model/View based programming. While there is perhaps slightly more
overhead to get started with this, there are many benefits. The Shotgun Model (and the corresponding delegates
and Shotgun View components) is an attempt to bridge this gap and make it quick and painless to get started
with Qt Model/View programming.</p>
<p>Qt provides a strong and mature Model/View hierarchy which is robust and easy to work with. If you are not
familiar with it, please check the following links:</p>
<ul class="simple">
<li>Tutorial: <a class="reference external" href="http://qt-project.org/doc/qt-4.8/modelview.html">http://qt-project.org/doc/qt-4.8/modelview.html</a></li>
<li>Technical details: <a class="reference external" href="http://qt-project.org/doc/qt-4.8/model-view-programming.html">http://qt-project.org/doc/qt-4.8/model-view-programming.html</a></li>
</ul>
<p>The benefits with this approach will become evident as you scale your UIs and their complexity. Developing code
and tools where the data and the UI is combined will work in simple scenarios but for data rich applications
this approach becomes hard to maintain, difficult to reuse and typically scales poorly as the dataset complexity grows.
By leveraging Qts built-in functionality, you get access to a mature and well documented toolbox that makes
it quick to develop tools:</p>
<ul class="simple">
<li>A Shotgun model instance represents a single shotgun query. With two lines of code you can connect the resultset
of such a query with a standard Qt list, tree or table.</li>
<li>The Shotgun model is cached, meaning that all data is fetched in the background in a worker thread. This means that
the data in your UI will load up instantly and you never have to wait for shotgun. If the query result is different
than the cached result, the view will be updated on the fly as the data arrives.</li>
<li>With Qt you have access to SelectionModels, making it easy to create consistent selection behavior, even across
multiple views. With full keyboard support.</li>
<li>With Qt proxy models you can easily create interactive searching and filtering on the client side.</li>
<li>Views and models are optimized and will perform nicely even if you have thousands of items loaded.</li>
<li>Through the shotgun view module, you can easily control the Qt <em>delegates</em> system, making it easy to
draw custom UIs for each cell in your view.</li>
</ul>
</div>
<div class="section" id="shotgun-model-hello-world">
<h3>Shotgun Model Hello World<a class="headerlink" href="#shotgun-model-hello-world" title="Permalink to this headline">¶</a></h3>
<p>A hello world style example would look something like this, assuming this code is inside a
toolkit app:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the shotgun_model module from the shotgun utils framework</span>
<span class="n">shotgun_model</span> <span class="o">=</span> <span class="n">tank</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">import_framework</span><span class="p">(</span><span class="s2">&quot;tk-framework-shotgunutils&quot;</span><span class="p">,</span> <span class="s2">&quot;shotgun_model&quot;</span><span class="p">)</span>
<span class="c1"># Set up alias</span>
<span class="n">ShotgunModel</span> <span class="o">=</span> <span class="n">shotgun_model</span><span class="o">.</span><span class="n">ShotgunModel</span>

<span class="c1"># Create a standard Qt Tree View</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QTreeView</span><span class="p">(</span><span class="n">parent_widget</span><span class="p">)</span>

<span class="c1"># Set up our data backend</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">shotgun_model</span><span class="o">.</span><span class="n">SimpleShotgunModel</span><span class="p">(</span><span class="n">parent_widget</span><span class="p">)</span>

<span class="c1"># Tell the view to pull data from the model</span>
<span class="n">view</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="c1"># load all assets from Shotgun</span>
<span class="n">model</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">entity_type</span><span class="o">=</span><span class="s2">&quot;Asset&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The above code will create a standard Qt tree view of all assets in Shotgun.</p>
</div>
<div class="section" id="beyond-hello-world">
<h3>Beyond Hello World<a class="headerlink" href="#beyond-hello-world" title="Permalink to this headline">¶</a></h3>
<p>The simple setup outlined above could be extended in the following ways:</p>
<ul class="simple">
<li>If you need more control of how the data is being retrieved, consider instead creating
your own class and derive from <a class="reference external" href="http://developer.shotgridsoftware.com/tk-framework-shotgunutils/shotgun_model.html#shotgun_model.ShotgunModel" title="(in tk-framework-shotgunutils vv5.8.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShotgunModel</span></code></a>. This makes it possible to customize
the shotgun data as it arrives from Shotgun, control the hierarchy grouping and many other
things.</li>
<li>If you want to retrieve results from your view, connect signals to the view’s selection model.</li>
<li>If you want to cull out items from the model, for example only to show items matching a particular
search criteria, use a Proxy Model (typically <a class="reference external" href="http://pyside.github.io/docs/pyside/PySide/QtGui/QSortFilterProxyModel.html#PySide.QtGui.QSortFilterProxyModel" title="(in PySide v1.2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QSortFilterProxyModel</span></code></a>).</li>
<li>If you want to control the way items are displayed in the view, consider using the Shotgun delegates
module which is part of the Qt widgets framework. For more information, see
<a class="reference external" href="http://developer.shotgridsoftware.com/tk-framework-qtwidgets/views.html#views.WidgetDelegate" title="(in tk-framework-qtwidgets vv2.10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">WidgetDelegate</span></code></a></li>
</ul>
</div>
<div class="section" id="progress-spinner">
<h3>Progress Spinner<a class="headerlink" href="#progress-spinner" title="Permalink to this headline">¶</a></h3>
<p>The model emits several signals at various points in its refresh cycle. If you want a spinner
to pop up to indicate that data is being loaded, simply add a <a class="reference external" href="http://developer.shotgridsoftware.com/tk-framework-qtwidgets/overlay_widget.html#overlay_widget.ShotgunModelOverlayWidget" title="(in tk-framework-qtwidgets vv2.10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShotgunModelOverlayWidget</span></code></a>
between your view and model, like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">overlay_widget</span> <span class="o">=</span> <span class="n">tank</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">import_framework</span><span class="p">(</span><span class="s2">&quot;tk-framework-qtwidgets&quot;</span><span class="p">,</span> <span class="s2">&quot;overlay_widget&quot;</span><span class="p">)</span>

<span class="c1"># once you have created a view and a model, set up an overlay object to</span>
<span class="c1"># track the model&#39;s activity. Whenver the model is loading data,</span>
<span class="c1"># the overlay will show a spinner.</span>

<span class="n">overlay</span> <span class="o">=</span> <span class="n">overlay_widget</span><span class="o">.</span><span class="n">ShotgunModelOverlayWidget</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">view</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to refine how the overlay behaves, simply subclass the class above.
This can be useful if you for example want to display a ‘no items found’ message whenever
a shotgun query returns zero items.</p>
</div>
<div class="section" id="data-items">
<h3>Data Items<a class="headerlink" href="#data-items" title="Permalink to this headline">¶</a></h3>
<p>The Shotgun Model derives from <a class="reference external" href="http://pyside.github.io/docs/pyside/PySide/QtGui/QStandardItemModel.html#PySide.QtGui.QStandardItemModel" title="(in PySide v1.2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QStandardItemModel</span></code></a> which is a base model which managed the storage
of model data inside a collection of <a class="reference external" href="http://pyside.github.io/docs/pyside/PySide/QtGui/QStandardItem.html#PySide.QtGui.QStandardItem" title="(in PySide v1.2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QStandardItem</span></code></a> objects. Each of these objects have a number of
standard property and so called <em>roles</em>, holding various pieces of data such as icons, colors etc.
The Shotgun Model introduces two new standard roles which can be used by both subclassing and calling
code:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">ShotgunModel.SG_DATA_ROLE</span></code> holds the shotgun data associated with an object. In a tree view, only
leaf nodes have this data defined - other nodes have it set to None. For leaf nodes, it is a standard
shotgun dictionary containing all the items that were returned by the Shotgun query.</li>
<li><code class="docutils literal notranslate"><span class="pre">ShotgunModel.SG_ASSOCIATED_FIELD_ROLE</span></code> holds the associated field value for a node. This is contained
in a dictionary with the keys name and value. For example, for a leaf node this is typically something
like <code class="docutils literal notranslate"><span class="pre">{&quot;name&quot;:</span> <span class="pre">&quot;code&quot;,</span> <span class="pre">&quot;value&quot;:</span> <span class="pre">&quot;AAA_123&quot;}</span></code>. For an intermediate node, it may be something such as
<code class="docutils literal notranslate"><span class="pre">{&quot;name&quot;:</span> <span class="pre">&quot;sg_sequence&quot;,</span> <span class="pre">&quot;value&quot;:</span> <span class="pre">{&quot;id&quot;:</span> <span class="pre">123,</span> <span class="pre">&quot;name&quot;:</span> <span class="pre">&quot;AAA&quot;,</span> <span class="pre">&quot;type&quot;:</span> <span class="pre">&quot;Sequence&quot;}</span> <span class="pre">}</span></code>.</li>
</ul>
</div>
</div>
<div class="section" id="simpleshotgunmodel">
<h2>SimpleShotgunModel<a class="headerlink" href="#simpleshotgunmodel" title="Permalink to this headline">¶</a></h2>
<p>Convenience wrapper around the Shotgun model for quick and easy access. Use this when you want
to prototype data modeling or if your are looking for a simple flat data set reflecting a
shotgun query. All you need to do is to instantiate the class (typically once, in your constructor)
and then call <a class="reference external" href="http://developer.shotgridsoftware.com/tk-framework-shotgunutils/shotgun_model.html#shotgun_model.SimpleShotgunModel.load_data" title="(in tk-framework-shotgunutils vv5.8.5)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SimpleShotgunModel.load_data()</span></code></a> to
specify which shotgun query to load up in the model. Subsequently call
<a class="reference external" href="http://developer.shotgridsoftware.com/tk-framework-shotgunutils/shotgun_model.html#shotgun_model.SimpleShotgunModel.load_data" title="(in tk-framework-shotgunutils vv5.8.5)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_data()</span></code></a> whenever you
wish to change the Shotgun query associated with the model.</p>
<p>This class derives from <a class="reference external" href="http://developer.shotgridsoftware.com/tk-framework-shotgunutils/shotgun_model.html#shotgun_model.ShotgunModel" title="(in tk-framework-shotgunutils vv5.8.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShotgunModel</span></code></a> so all the
customization methods available in the
normal ShotgunModel can also be subclassed from this class.</p>
</div>
<div class="section" id="shotgunentitymodel">
<h2>ShotgunEntityModel<a class="headerlink" href="#shotgunentitymodel" title="Permalink to this headline">¶</a></h2>
<p>Another convenience wrapper around the <a class="reference external" href="http://developer.shotgridsoftware.com/tk-framework-shotgunutils/shotgun_model.html#shotgun_model.ShotgunModel" title="(in tk-framework-shotgunutils vv5.8.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShotgunModel</span></code></a>. This model is useful when you
want to represent a tree view of Sequences, Shots or Assets. By default, the model will
associate standard dark-style Shotgun entity type icons to items in the list.</p>
</div>
<div class="section" id="shotgunmodel">
<h2>ShotgunModel<a class="headerlink" href="#shotgunmodel" title="Permalink to this headline">¶</a></h2>
<p>A Qt Model representing a Shotgun query.</p>
<p>This class implements a standard <a class="reference external" href="http://pyside.github.io/docs/pyside/PySide/QtCore/QAbstractItemModel.html#PySide.QtCore.QAbstractItemModel" title="(in PySide v1.2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QAbstractItemModel</span></code></a> specialized to hold the contents
of a particular Shotgun query. It is cached and refreshes its data asynchronously.</p>
<p>The model can either be a flat list or a tree. This is controlled by a grouping
parameter which works just like the Shotgun grouping. For example, if you pull
in assets grouped by asset type, you get a tree of data with intermediate data
types for the asset types. The leaf nodes in this case would be assets.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="shotgun_hierarchy_model.html" class="btn btn-neutral float-right" title="Shotgun Hierarchy Model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="The Shotgun Utilities Framework" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, Autodesk

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-2114792-1', 'auto');
  ga('send', 'pageview');
</script>



</body>
</html>